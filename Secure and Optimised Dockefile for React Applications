# Use the official NGINX unprivileged image
FROM nginxinc/nginx-unprivileged:1.29.3-alpine

# Set working directory to NGINX html directory
WORKDIR /usr/share/nginx/html

# Copy React build to NGINX html directory
COPY dist/ .

# Remove default config and add custom NGINX config
RUN rm /etc/nginx/conf.d/default.conf
COPY nginx/nginx.conf /etc/nginx/conf.d/

# Expose the container port (NGINX unprivileged listens on 8080)
EXPOSE 8080

# Switch to NGINX non-root user (already default-optional)
USER nginx

# Start NGINX in the foreground
CMD ["nginx", "-g", "daemon off;"]
